require('@testing-library/jest-dom')
const { configure } = require('@testing-library/react')
const userEvent = require('@testing-library/user-event').default

// Configure testing library
configure({
  asyncUtilTimeout: 1000,
  computedStyleSupportsPseudoElements: true,
  defaultHidden: true,
  eventWrapper: cb => cb()
})

// Setup userEvent
global.userEvent = userEvent

// Mock requestAnimationFrame
global.requestAnimationFrame = cb => setTimeout(cb, 0)

// Mock console.error to fail tests on prop type errors
const originalError = console.error
console.error = (...args) => {
  const propTypeFailures = [
    'Failed prop type',
    'Invalid prop',
    'Invalid event handler',
    'Non-boolean attribute',
    'React does not recognize',
    'Unknown prop'
  ]

  if (propTypeFailures.some(failure => args.join(' ').includes(failure))) {
    throw new Error(args.join(' '))
  }

  originalError.apply(console, args)
}
